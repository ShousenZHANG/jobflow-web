# Jobflow ğŸš€

A practical job search command center: fetch roles, review fast, tailor CV/Cover Letter, and export production-ready PDFs.

[English](#english) | [Chinese ä¸­æ–‡](#chinese-ä¸­æ–‡)

![Next.js](https://img.shields.io/badge/Next.js-16-black)
![React](https://img.shields.io/badge/React-19-149eca)
![TypeScript](https://img.shields.io/badge/TypeScript-5-3178c6)
![Prisma](https://img.shields.io/badge/Prisma-7-2d3748)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-Database-336791)
![Vercel](https://img.shields.io/badge/Deploy-Vercel-black)
![GitHub Actions](https://img.shields.io/badge/CI-GitHub_Actions-2088ff)
![Vitest](https://img.shields.io/badge/Test-Vitest-729b1b)
![License](https://img.shields.io/badge/License-Apache--2.0-blue)
<!-- AUTO_METRICS_BADGES_START -->
![API Routes](https://img.shields.io/badge/API_Routes-23-0ea5e9)
![API Handlers](https://img.shields.io/badge/API_Handlers-28-0284c7)
![Test Files](https://img.shields.io/badge/Test_Files-22-65a30d)
![Prisma Models](https://img.shields.io/badge/Prisma_Models-10-7c3aed)
![Server Modules](https://img.shields.io/badge/Server_Modules-19-334155)
![UI Pages](https://img.shields.io/badge/UI_Pages-6-0f766e)
<!-- Generated by: npm run readme:metrics -->
<!-- AUTO_METRICS_BADGES_END -->

## Table of Contents

- [English](#english)
- [Chinese ä¸­æ–‡](#chinese-ä¸­æ–‡)

## Quick Navigation

[Live Demo](#live-demo) Â· [Architecture](#architecture) Â· [Tech Stack](#key-technology-stack) Â· [Quick Start](#quick-start) Â· [Chinese](#chinese-ä¸­æ–‡)

## English

### What Jobflow Does

Jobflow is built as a real workflow product, not a prompt-only demo.

- End-to-end flow: role intake, triage, tracking, tailoring, export
- Reliable data path: dedupe, tombstone filtering, guarded imports
- Controllable AI: automatic generation plus manual external-model import
- Prompt governance: versioned rule templates + skill pack delivery
- Delivery-ready output: LaTeX-based Resume and Cover Letter PDFs

### Core Features

1. **Job Intake Pipeline**
- Create `FetchRun` tasks from `/fetch`
- Dispatch GitHub Actions to run Python JobSpy fetcher
- Pull run config and push run status through secured API routes
- Import with unique-key dedupe (`userId + jobUrl`) and deleted-URL tombstones

2. **Jobs Workspace**
- Two-pane review UI for fast list scanning and deep JD reading
- Search/filter/pagination and status transitions (`NEW`, `APPLIED`, `REJECTED`)
- Markdown JD rendering and keyword highlighting

3. **Resume Studio**
- Multi-step master resume editor (basics, summary, experience, projects, education, skills)
- Bullet-level edits with markdown emphasis
- Preview + save workflow

4. **Prompt Rules + Skill Pack**
- Create/activate/reset versioned prompt templates
- Download global skill pack for external model workflows

5. **AI Tailoring + Manual Import**
- AI tailoring with fallback when provider/key/output is unavailable
- Manual JSON import path (`copy prompt -> external model -> import`)
- Guardrails: strict schema checks, `promptMeta` consistency, evidence-grounded bullet additions

6. **PDF Delivery**
- Resume/Cover LaTeX rendering and PDF download
- Optional persistent resume PDF storage via Vercel Blob
- Cover PDF persistence is also supported when blob token is configured

7. **Codex Batch Run (Manual AI Loop)**
- Create a `NEW`-scope batch from filtered jobs
- Use `/api/application-batches/:id/codex-run` to claim tasks + prompt context
- Generate JSON (resume/cover) and import via `/api/applications/manual-generate`
- Mark task status via `/api/application-batches/:id/tasks/:taskId`
- Track completion via `/api/application-batches/:id/summary`

### Key Technology Stack

| Domain | Technology | Usage Status |
|---|---|---|
| Frontend | Next.js 16 (App Router), React 19, TypeScript | Active |
| UI | Tailwind CSS v4, Radix UI, shadcn-style components, Framer Motion | Active |
| Auth | NextAuth (GitHub + Google) | Active |
| Backend API | Next.js Route Handlers + Zod validation | Active |
| ORM/Data Layer | Prisma 7 | Active |
| Database | PostgreSQL | Active |
| DB Platform Adapter | Neon (`@prisma/adapter-neon`, `@neondatabase/serverless`) | Active |
| Deployment Cloud | Vercel | Active |
| CI/Automation | GitHub Actions | Active |
| External Fetch Worker | Python JobSpy | Active |
| AI Provider | Gemini API with safe fallback path | Active when configured |
| File Storage | Vercel Blob | Optional |
| PDF Engine | LaTeX compile pipeline | Active |
| Testing | Vitest + Testing Library | Active |
| Azure | Mentioned in historical design docs | Not active in current runtime |

### Architecture

```mermaid
flowchart LR
  U[User] --> FE[Next.js UI]
  FE --> API[Next.js API Routes]
  API --> DB[(PostgreSQL via Prisma)]
  FE --> AUTH[NextAuth]

  FE --> FR[Create FetchRun]
  FR --> GH[GitHub Actions]
  GH --> PY[Python JobSpy Fetcher]
  PY --> CFG[Fetch Config API]
  PY --> IMP[Admin Import API]
  PY --> UPD[Run Update API]
  IMP --> DB

  FE --> AIPATH[Prompt and Manual Import APIs]
  AIPATH --> GM[Gemini Provider]
  AIPATH --> PDF[LaTeX Render and Compile]
  PDF --> BLOB[Vercel Blob Optional]
  PDF --> DL[PDF Download]
  FE --> BATCH[Application Batch APIs]
  BATCH --> CODX[Codex Manual Loop]
  CODX --> AIPATH
```

### Live Demo

- Local demo: `http://localhost:3000`
- Cloud deployment: Vercel (set env vars, then deploy)

### Project Structure

- `app/(marketing)` marketing pages
- `app/(auth)` auth pages
- `app/(app)` app workspace (`jobs`, `fetch`, `resume`, `resume/rules`)
- `app/api` backend routes
- `lib/server` domain services (AI, prompts, PDF, persistence)
- `prisma/schema.prisma` data models
- `tools/fetcher` fetcher integration
- `test` test suites

### Quick Start

```bash
npm install
npm run dev
```

Open `http://localhost:3000`

### Scripts

- `npm run dev` local development
- `npm run build` production build
- `npm run start` production server
- `npm run lint` lint
- `npm test` run tests
- `npm run test:watch` test watch mode
- `npm run readme:metrics` refresh auto metrics badges

### Codex Batch Workflow

1. Fetch jobs and keep only roles you want as `NEW`.
2. Create batch: `POST /api/application-batches` (scope `NEW`).
3. In Codex loop:
   - call `POST /api/application-batches/:id/codex-run`
   - for each returned task:
     - call `POST /api/applications/prompt` (`target=resume|cover`)
     - generate JSON with your model
     - call `POST /api/applications/manual-generate`
     - call `PATCH /api/application-batches/:id/tasks/:taskId` with `SUCCEEDED` or `FAILED`
4. Check progress/remaining/failed with `GET /api/application-batches/:id/summary`.

### Environment Variables

Create a `.env` file in the project root.

**App + Auth**
- `DATABASE_URL`
- `NEXTAUTH_SECRET` or `AUTH_SECRET`
- `NEXTAUTH_URL`
- `GOOGLE_CLIENT_ID`
- `GOOGLE_CLIENT_SECRET`
- `GITHUB_ID`
- `GITHUB_SECRET`

**Fetch + Workflow**
- `GITHUB_OWNER`
- `GITHUB_REPO`
- `GITHUB_TOKEN` (workflow scope required)
- `GITHUB_WORKFLOW_FILE` (default: `jobspy-fetch.yml`)
- `GITHUB_REF` (default: `master`)
- `JOBFLOW_WEB_URL`
- `FETCH_RUN_SECRET`
- `IMPORT_SECRET`

**AI + Files**
- `GEMINI_API_KEY`
- `GEMINI_MODEL` (optional)
- `BLOB_READ_WRITE_TOKEN` (optional)

### Deployment

- Recommended: Vercel + Neon (PostgreSQL)
- Configure all env vars in deployment platform
- If deploying from a subdirectory, set root directory to `jobflow`

### Troubleshooting

- `GITHUB_DISPATCH_FAILED`: check workflow token permissions
- Low import volume: increase `resultsWanted` / `hoursOld` or relax excludes
- `PROMPT_META_MISMATCH`: regenerate skill pack and prompt
- `/api/application-batches/:id/trigger` returns `TRIGGER_DISABLED` by design; use `codex-run` loop

### License

Apache License 2.0. See `LICENSE` and `NOTICE`.

---

## Chinese (ä¸­æ–‡)

### é¡¹ç›®å®šä½

Jobflow æ˜¯ä¸€ä¸ªçœŸå®å¯ç”¨çš„æ±‚èŒå·¥ä½œå°ï¼šæŠ“å–èŒä½ã€ç­›é€‰è·Ÿè¿›ã€å®šåˆ¶ç®€å†ä¸æ±‚èŒä¿¡ï¼Œå¹¶å¯¼å‡º PDFã€‚

- å…¨é“¾è·¯é—­ç¯ï¼šæŠ“å– -> è¯„ä¼° -> è·Ÿè¿› -> äº§å‡º
- æ•°æ®ç¨³å®šï¼šå»é‡ã€å¢“ç¢‘æœºåˆ¶ã€å®‰å…¨å¯¼å…¥
- AI å¯æ§ï¼šè‡ªåŠ¨ç”Ÿæˆ + æ‰‹åŠ¨å¯¼å…¥åŒè·¯å¾„
- è§„åˆ™å¯æ²»ç†ï¼šPrompt ç‰ˆæœ¬åŒ–ä¸ Skill Pack
- å¯ç›´æ¥äº¤ä»˜ï¼šResume/Cover Letter PDF

### å…³é”®èƒ½åŠ›

- æŠ“å–é“¾è·¯ï¼š`FetchRun` + GitHub Actions + Python JobSpy + å®‰å…¨å›è°ƒæ¥å£
- èŒä½å·¥ä½œå°ï¼šåŒæ æµè§ˆã€æœç´¢ç­›é€‰ã€çŠ¶æ€ç®¡ç†ã€JD æ¸²æŸ“
- ä¸»ç®€å†ç¼–è¾‘ï¼šå¤šæ­¥éª¤ç»“æ„åŒ–ç»´æŠ¤ä¸é¢„è§ˆ
- Prompt Rulesï¼šç‰ˆæœ¬åŒ–ã€æ¿€æ´»ã€æ¢å¤é»˜è®¤ã€Skill Pack ä¸‹è½½
- å®šåˆ¶ç”Ÿæˆï¼šAI + æ‰‹åŠ¨å¯¼å…¥ï¼Œå¸¦ä¸¥æ ¼æ ¡éªŒä¸è¯æ®çº¦æŸ
- PDF è¾“å‡ºï¼šLaTeX æ¸²æŸ“ï¼Œæ”¯æŒ Vercel Blob å¯é€‰æŒä¹…åŒ–

### å…³é”®æŠ€æœ¯æ ˆ

- å‰ç«¯ï¼šNext.js 16ã€React 19ã€TypeScriptã€Tailwind CSS v4ã€Radix UI
- åç«¯ï¼šNext.js API Routesã€Zodã€Prisma 7
- æ•°æ®åº“ï¼šPostgreSQLï¼ˆNeon é€‚é…ï¼‰
- äº‘ä¸è‡ªåŠ¨åŒ–ï¼šVercelã€GitHub Actionsã€Python JobSpy
- AI ä¸å†…å®¹ï¼šGeminiã€React Markdownã€LaTeX
- å­˜å‚¨ï¼šVercel Blobï¼ˆå¯é€‰ï¼‰
- æµ‹è¯•ï¼šVitest + Testing Library
- Azureï¼šå½“å‰è¿è¡Œé“¾è·¯æœªå¯ç”¨ï¼Œä»…å†å²è®¾è®¡æ–‡æ¡£æåŠ

### å¿«é€Ÿå¼€å§‹

```bash
npm install
npm run dev
```

è®¿é—® `http://localhost:3000`

### è®¸å¯è¯

Apache License 2.0ï¼Œè§ `LICENSE` ä¸ `NOTICE`ã€‚
